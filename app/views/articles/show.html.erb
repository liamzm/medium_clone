


<%= image_tag(@article.image_url.to_s) %>

<h1><%= @article.title %> </h1>


<h2><%= @article.subhead %> </h2>

<p>Written by: <a href="/users/<%= @article.user_id %>"> <%= @author.first_name %> </a> </p>

<p><%= @article.address %> </p>

<div id="map"></div>

<p><%= simple_format(@article.content) %> </p>


	<% if current_user != nil %>


		<%= link_to like_article_path(@article), :class => 'like-btn', method: :put, remote: :true do %>

			<div>

				<span><p><i>Like this article</i></p></span>


			</div>

		<% end %>

	<% else %>

		<%= link_to 'Upvote', new_session_path %>

	<% end %>

		<p class="likes-count"><%= @article.get_upvotes.size %></p>


<h3> Post a comment </h3>

<% if current_user != nil %>


	<% if @article.user_id == current_user.id %>

		<p> <%= link_to 'Edit Article', edit_article_path(@article) %> </p>

	<% end %>

	

		<%= form_for [@article, @comment] do |f| %>


			<%= f.label :type_your_comment_below %>
			<%= f.text_area :content %>

			<% f.hidden_field :user_id, :value => current_user.id %>
			<% f.hidden_field :article_id, :value => @article.id %>

			<%= f.submit :'Post your comment' %>


		<% end %>

		<% else %>

		<p> You must be <%= link_to 'signed in', new_session_path %> to post a comment </p>


<% end %>

	<% @comments.each do |comment|%>


		<a href="/users/<%= comment.user_id %>"><%= comment.user.first_name %> </a>

		<p><strong><%= time_ago_in_words(comment.created_at) %> ago</strong></p> 


		<p><%= comment.content %></p>

		


	<% end %>




<script>
      function initMap() {
        var myLatLng = {lat: <%=@article.latitude %>, lng: <%=@article.longitude %>};

        var map = new google.maps.Map(document.getElementById('map'), {
          zoom: 6,
          center: myLatLng
        });

        var marker = new google.maps.Marker({
          position: myLatLng,
          map: map,
          title: 'Tasty food map'
        });
      }
    </script>
    <script async defer
    src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBKHH_JtyjdFmkCMfEsacPf5WnxSxNbEf0&callback=initMap">
    </script>
  </body>
</html>

